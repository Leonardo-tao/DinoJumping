{"ast":null,"code":"export default {\n  name: 'playGame',\n  data() {\n    return {\n      ctx: null,\n      canvasWidth: 2400,\n      canvasHeight: 100,\n      speed: 0.01,\n      groundX: -10,\n      images: {\n        start: \"dino_start\",\n        ground: \"\"\n        // jump: \"\",\n        // die: \"\",\n        // cloud: \"\",\n        // left: \"\",\n        // right: \"\",\n        // cactus: \"\",\n        // endTitle: \"\",\n        // bird: \"\",\n        // score: [\n\n        // ]\n      }\n    };\n  },\n  methods: {\n    drawPic(pic, x, y, w, h) {\n      let img = new Image();\n      img.src = this.images[pic];\n      // img.src = require(`/src/assets/images/${pic}.png`)\n\n      img.onload = () => {\n        if (w === undefined) w = img.width;\n        if (h === undefined) h = img.height;\n        if (y === undefined) y = this.canvasHeight - h;\n        if (x === undefined) x = 0;\n        this.ctx.drawImage(img, x, y, w, h);\n      };\n      img.onerror = () => {\n        console.error(`加载图片失败: ${img.src}`);\n      };\n    },\n    updateGroundPosition() {\n      this.groundX -= this.speed;\n      if (this.groundX <= -this.canvasWidth) {\n        this.groundX = 0;\n      }\n\n      // this.speed += 0.01 // 逐渐加速\n      console.log(this.groundX);\n    },\n    animate() {\n      this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n      this.drawPic('ground', this.groundX, this.canvasHeight - 26);\n      this.drawPic('start', 100, 40, 52, 52);\n      this.updateGroundPosition();\n      requestAnimationFrame(this.animate.bind(this));\n    }\n  },\n  mounted() {\n    this.ctx = document.getElementById('canvas').getContext(\"2d\");\n\n    // 确保图片资源加载完成后启动动画\n    const imagePromises = Object.values(this.images).map(imageSrc => {\n      return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.src = imageSrc;\n        img.onload = resolve;\n        img.onerror = reject;\n      });\n    });\n    Promise.all(imagePromises).then(() => {\n      this.animate(); // 所有图片加载完成后启动动画\n    }).catch(error => {\n      console.error(\"图片加载失败：\", error);\n    });\n  }\n};","map":{"version":3,"names":["name","data","ctx","canvasWidth","canvasHeight","speed","groundX","images","start","ground","methods","drawPic","pic","x","y","w","h","img","Image","src","onload","undefined","width","height","drawImage","onerror","console","error","updateGroundPosition","log","animate","clearRect","requestAnimationFrame","bind","mounted","document","getElementById","getContext","imagePromises","Object","values","map","imageSrc","Promise","resolve","reject","all","then","catch"],"sources":["E:\\code\\Web\\dino\\src\\components\\game.vue"],"sourcesContent":["<template>\n  <div class=\"game\">\n    <canvas id=\"canvas\" :width=\"canvasWidth\" :height=\"canvasHeight\" />\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'playGame',\n  data() {\n    return {\n      ctx: null,\n      canvasWidth: 2400,\n      canvasHeight: 100,\n      speed: 0.01,\n      groundX: -10,\n      images: {\n        start: \"dino_start\",\n        ground: \"\",\n        // jump: \"\",\n        // die: \"\",\n        // cloud: \"\",\n        // left: \"\",\n        // right: \"\",\n        // cactus: \"\",\n        // endTitle: \"\",\n        // bird: \"\",\n        // score: [\n\n        // ]\n      }\n    }\n  },\n  methods: {\n    drawPic(pic, x, y, w, h){\n      let img = new Image()\n\n      img.src = this.images[pic]\n      // img.src = require(`/src/assets/images/${pic}.png`)\n\n      img.onload = () =>{\n        if (w === undefined) w = img.width\n        if (h === undefined) h = img.height\n        if (y === undefined) y = this.canvasHeight - h\n        if (x === undefined) x = 0\n\n        this.ctx.drawImage(img, x, y, w, h)\n      }\n\n      img.onerror = () => {\n        console.error(`加载图片失败: ${img.src}`);\n      }\n    },\n    updateGroundPosition() {\n      this.groundX -= this.speed\n\n      if (this.groundX <= -this.canvasWidth) {\n        this.groundX = 0\n      }\n\n      // this.speed += 0.01 // 逐渐加速\n      console.log(this.groundX)\n    },\n    animate() {\n      this.ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight)\n\n      this.drawPic('ground', this.groundX, this.canvasHeight - 26)\n      this.drawPic('start', 100, 40, 52, 52)\n\n      this.updateGroundPosition()\n\n      requestAnimationFrame(this.animate.bind(this))\n    }\n  },\n  mounted() {\n    this.ctx = document.getElementById('canvas').getContext(\"2d\")\n\n    // 确保图片资源加载完成后启动动画\n    const imagePromises = Object.values(this.images).map(imageSrc => {\n      return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.src = imageSrc;\n\n        img.onload = resolve;\n        img.onerror = reject;\n      });\n    });\n\n    Promise.all(imagePromises)\n      .then(() => {\n        this.animate(); // 所有图片加载完成后启动动画\n      })\n      .catch(error => {\n        console.error(\"图片加载失败：\", error);\n      })\n  }\n}\n</script>\n\n<style scoped>\n#canvas {\n  background-color: #000;\n  border: 1px solid #000;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}